/*
 * Copyright (C) 2009-2021 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["./BaseController","../utils/AmountImportDialog","../utils/Formatter","sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","./Constants"],function(B,A,F,E,a,C){"use strict";return B.extend("ehs.em.import.datas1.controller.Import",{onInit:function(){this.getView().setBusy(true);},onAfterRendering:function(){this.onImportPress();this.getView().setBusy(false);},onImportPress:function(){var i=new A(this.getView());i.open();},onTemplateDownload:function(){var m=jQuery.sap.getModulePath("ehs.em.import.datas1","/attachments/EnvDataImportTemplate.xlsx.zip");sap.m.URLHelper.redirect(m,false);},onExportCSV:function(){var t=this;var s=this.byId("severityLabel");var m=this.byId("messageLabel");var f=function(v){if(v){var r=v.replace('""','"');r=r.replace(","," ");return r;}};var b=function(v){return F.formatMessageSeverity(v,t);};var e=new E({exportType:new a({separatorChar:",",charset:"utf-8"}),models:this.getModel("messages"),rows:{path:"/rows"},columns:[{name:s.getText(),template:{content:{path:C.messageTableHeader.severity,formatter:b}}},{name:m.getText(),template:{content:{path:C.messageTableHeader.message,formatter:f}}}]});e.saveFile("ImportEnvDataMessages").always(function(){this.destroy();});},onPressCollection:function(e){var c=e.getSource();var o=c.getBindingContext("messages");var p={};var b=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");for(var i=0;i<C.monitorParams.length;i++){p[C.monitorParams[i]]=o.getProperty(C.monitorParams[i]);}var d={target:C.monitorTarget,params:p};if(b){b.isNavigationSupported([d]).done(function(r){if(r[0].supported===true){b.toExternal(d);}});}},formatter:F});});
